# BlackMautz TML Telemetry - The Bus (Universal Edition)

> **âš ï¸ WORK IN PROGRESS**  
> Dieses Plugin wird aktiv weiterentwickelt! Bugfixes, neue Features und Icon-Updates kommen regelmÃ¤ÃŸig.  
> **ğŸ‘€ Repository beobachten** um Updates nicht zu verpassen: Klicke auf **"Watch"** â†’ **"Releases only"**

---

## ğŸŒ Language / Sprache

**ğŸ‡©ğŸ‡ª [Deutsch](#-deutsch) | ğŸ‡ºğŸ‡¸ [English](#-english)**

---

<br>
<br>

# ğŸ‡©ğŸ‡ª Deutsch

**Ein Stream Deck Plugin fÃ¼r ALLE Busse in The Bus!**

UnterstÃ¼tzt **Solaris Urbino**, **Mercedes eCitaro**, **Scania Citywide** UND **VDL Citea LLE** mit allen Features in einem Plugin!

**Version 2.0.4** - Alle Funktionen getestet und funktionsfÃ¤hig in allen vier Bussen!

## ğŸ“¥ Installation & Updates

### Installation
1. **[Download v2.0.4](https://github.com/BlackMautz/BlackMautz_telemetry_TheBus-streamdeck-custom/releases)** - Neueste `.streamDeckPlugin` Datei
2. **Doppelklick** auf die Datei
3. **Fertig!** Stream Deck installiert automatisch

### ğŸ”” Updates nicht verpassen!
Klicke oben rechts auf **"Watch"** â†’ **"Custom"** â†’ **"Releases"** âœ…  
â†’ Du bekommst automatisch eine Email wenn ein neues Update da ist! ğŸ“§

---

## ğŸ® Alle Features auf einen Blick

**45 Buttons mit Ã¼ber 100+ einzelnen Funktionen!**

### ğŸšª TÃ¼rsteuerung (5 Buttons)
- **Door 1-4** - Einzelne TÃ¼ren Ã¶ffnen/schlieÃŸen mit Lock-Funktion
  - ğŸ“Š Door Progress Display (zeigt Ã–ffnung in %, Scania: 0-100%, andere: 0%/100%)
- **Change Door** - 6 Optionen:
  - First Door Open/Close
  - Second Door Open/Close  
  - Third Door Open/Close
  - Fourth Door Open/Close
  - All Doors Open/Close
  - Automatic Door Closing

### ğŸ’° Kassensystem (2 Buttons)
- **Payment Status** - Zahlungsstatus-Anzeige
- **Change Action** - Wechselgeld zurÃ¼ckgeben

### âš™ï¸ Fahrzeugsteuerung (6 Buttons)
- **Gear Select** - Automatische Gangwahl (D/N/R)
- **Ignition** - ZÃ¼ndung an/aus
- **Start Engine** - Motor starten/stoppen
- **Fixing Brake** - Feststellbremse Toggle
- **Stop Brake (Mercedes)** - Haltestellenbremse
- **Wheelchair Ramp** - Rollstuhlrampe aus-/einfahren

### ğŸ’¡ Beleuchtung (7 Buttons mit 40+ Optionen!)
- **Light Control** - 15+ Licht-Optionen:
  - Interior Lights On/Off
  - Side/Rear/Front Lights On/Off
  - Hazard Lights On/Off
  - Turn Signals Left/Right On/Off
  - Fog Lights Front/Rear On/Off
  - High Beam On/Off
  - All Lights On/Off
- **Light Switch** - 3-Wege-Schalter mit 6 Positionen:
  - Nach Rechts schalten: Off â†’ Parking â†’ Headlights â†’ High Beam â†’ Fog Front â†’ Fog Rear
  - Nach Links schalten (umgekehrt)
  - Status anzeigen
- **Indicator Control** - 3 Optionen:
  - Turn Signal Left/Right
  - Hazard Lights
- **Scania Lights (Scania)** - 6 Optionen:
  - Fog Light Front/Rear
  - Interior Light Front/Back Up (Gedimmt)
  - Interior Light Front/Back Down (Hell)
- **Interior Light Dim (Mercedes/VDL)** - Innenbeleuchtung 30% gedimmt Toggle
- **Interior Light Full (Mercedes/VDL)** - Innenbeleuchtung 100% hell Toggle
- **Reading Light Clearance (VDL)** - Leselampen-Freigabe fÃ¼r Passagiere

### ğŸªŸ Fenster & Klima (3 Buttons)
- **Window Control** - 10 Optionen:
  - Driver Window Open/Close
  - Window Shade Up/Down
  - Window Shade Side Up/Down (VDL)
  - Window Shade Front Up/Down (Scania)
  - Window Shade Left Up/Down (Scania)
- **Window/Mirror Heating** - Scheiben-/Spiegelheizung Toggle
- **Climate Control** - Temperatur & LÃ¼ftung anzeigen

### ğŸ”½ Kneeling & Lifting (2 Buttons)
- **Kneeling/Lifting** - 6 Optionen:
  - Lifting Front
  - Lifting Rear
  - Kneeling Front
  - Kneeling Rear
  - Lifting
  - Kneeling

### ğŸŒ§ï¸ Scheibenwischer (2 Buttons)
- **Wiper Speed Up** - Stufe erhÃ¶hen
- **Wiper Speed Down** - Stufe verringern

### ğŸ“¯ Hupe & Signale (2 Buttons)
- **Horn** - Hupe
- **Flash High Beam** - Fernlichtblitz/Lichthupe

### ğŸ“¹ Kameras (1 Button)
- **Camera Switch** - Kamera umschalten (funktioniert mit allen 4 Bussen!)

### ğŸš¦ Spezial-Features (5 Buttons)
- **Pantograph On/Off (Solaris)** - Stromabnehmer fÃ¼r Trolleybus
- **Retarder Toggle** - Motorbremse/Dauerbremse (universal)
- **Traction Control (ASR)** - Antriebsschlupfregelung Toggle (universal)
- **RBL Toggle** - Ampel-Vorrang-System fÃ¼r grÃ¼ne Welle
  - Computer-gesteuertes Betriebsleitsystem
  - Bus bekommt automatisch GrÃ¼n an Ampeln
- **USB Clearance** - USB-Freigabe

### ğŸ“Š Info-Displays (5 Buttons)
- **Fuel Info** - Kraftstoffstand anzeigen
- **Passengers Info** - Passagieranzahl anzeigen
- **Engine Info** - Motorstatus anzeigen
- **Speed Info** - Geschwindigkeit anzeigen
- **Stop Request** - Haltewunsch-Anzeige

### ğŸ›ï¸ Erweiterte Features (2 Buttons)
- **Custom Action** - Eigene Events ohne Button-Funktion
- **Custom Button** - Eigene Events mit Button-Funktion

### ğŸ’¡ Monitoring (1 Button)
- **LED Monitor** - Alle LED-Stati Ã¼berwachen

---

## ğŸ¯ KompatibilitÃ¤t

| Feature | Solaris Urbino | Mercedes eCitaro | Scania Citywide | VDL Citea LLE |
|---------|:--------------:|:----------------:|:---------------:|:-------------:|
| Alle Standard-Features | âœ… | âœ… | âœ… | âœ… |
| Door Progress Display | âš ï¸ (nur bei TÃ¼ren) | âš ï¸ (nur bei TÃ¼ren) | âœ… (0-100%) | âš ï¸ (nur bei TÃ¼ren) |
| Light Switch | âœ… | âœ… | âœ… | âœ… |
| Pantograph | âœ… | âŒ | âŒ | âŒ |
| Interior Light Toggles | âŒ | âœ… | âŒ | âœ… |
| Stop Brake | âŒ | âœ… | âŒ | âŒ |
| Unified DoorLock | âŒ | âŒ | âœ… | âŒ |
| Scania Lights | âŒ | âŒ | âœ… | âŒ |
| Reading Light | âŒ | âŒ | âŒ | âœ… |
| Retarder | âœ… | âœ… | âœ… | âœ… |
| Traction Control (ASR) | âœ… | âœ… | âœ… | âœ… |
| RBL | âœ… | âœ… | âœ… | âœ… |

**Hinweis:** Bus-spezifische Buttons sind im Namen gekennzeichnet. Universelle Features funktionieren in allen Bussen!

## âœ¨ Highlights

### ğŸš€ Was ist neu in v2.0.4?
- ğŸš¦ **Retarder, ASR & RBL** - Professionelle Bus-Features fÃ¼r alle 4 Busse
- ğŸ’¡ **VDL Reading Light** - Leselampen-Freigabe fÃ¼r Passagiere
- ğŸ”„ **Ampel-Vorrang-System (RBL)** - Automatisch grÃ¼ne Ampeln bekommen
- ğŸ“Š **API-basierte Icon-Synchronisation** - Icons zeigen immer den echten Bus-Status

### ğŸ¯ Warum dieses Plugin?
- âœ… **Alle 4 Busse** in einem Plugin - keine separaten Downloads mehr!
- âœ… **100+ Funktionen** - Komplette Bus-Kontrolle vom Stream Deck
- âœ… **Smart Icons** - Zeigen automatisch den aktuellen Status
- âœ… **Door Progress** - Sieh die TÃ¼rÃ¶ffnung in Echtzeit (Scania: 0-100%)
- âœ… **Light Switch** - Alle 6 Lichtpositionen mit einem Button durchschalten
- âœ… **Custom Events** - Erstelle deine eigenen Buttons fÃ¼r spezielle Aktionen

---

## ğŸ“‹ Changelog

### v2.0.4 - VDL Extended Features (2025-11-29)
- ğŸ’¡ **Reading Light Clearance** - Leselampen-Freigabe fÃ¼r Passagiere (VDL)
- ğŸš¦ **Retarder Toggle** - Motorbremse/Dauerbremse ein/aus (universal)
- ğŸš— **Traction Control (ASR)** - Antriebsschlupfregelung Toggle (universal)
- ğŸš¦ **RBL Toggle** - Ampel-Vorrang-System fÃ¼r grÃ¼ne Welle
  - RBL = Rechnergesteuertes Betriebsleitsystem
  - Computer-gesteuertes Ampel-Vorrang-System
  - Bus meldet sich bei Ampeln und bekommt automatisch GrÃ¼n
  - HÃ¤ufig in Deutschland/Ã–sterreich bei Ã–PNV verwendet
- ğŸ“¹ **Camera Switch Fix** - Funktioniert jetzt mit allen 4 Bussen (SwitchPreviousCamera fÃ¼r VDL)

### v2.0.3 - VDL Citea LLE Support (2025-11-29)
- âœ¨ **VDL Citea LLE Support** - Vierter Bus komplett unterstÃ¼tzt!
- ğŸ’¡ **VDL Interior Light Toggles** - Gedimmt (30%) und Hell (100%)
- ğŸ”„ **API-basierte Status-Synchronisation** - Icons synchronisieren sich mit Bus-Status
- ğŸ“Š **3-State Interior Lights** - Primary (Off), Secondary (Bright), Tertiary (Dimmed)
- ğŸšª **VDL Door Events** - Event-Namen angepasst fÃ¼r VDL

### v2.0.2 - Scania Support & Door Progress (2025-11-29)
- âœ¨ **Scania Citywide Support** - Dritter Bus komplett unterstÃ¼tzt!
- ğŸ“Š **Door Progress Display** - Zeigt TÃ¼rÃ¶ffnung in % (Scania: 0-100%)
- ğŸ’¡ **Light Switch Button** - 3-Wege Schalter fÃ¼r 6 Lichtpositionen
- ğŸ’¡ **Scania Lights Button** - Nebellichter + Innenraumbeleuchtung
- ğŸªŸ **Window Shade Scania** - Front/Left Up/Down Optionen

### v2.0.0 - Universal Edition (2025-11-28)
- âœ¨ **Erste Universal-Version** - Solaris & Mercedes in einem Plugin
- âœ… Alle Features beider Busse vereint
- âœ… Separate Kategorie "BlackMautz TML Telemetry - ALL"

---

## ğŸ’» FÃ¼r Entwickler

### Plugin-Struktur
```
de.blackmautz.telemetry.universal.sdPlugin/
â”œâ”€â”€ app.js                 # Hauptlogik
â”œâ”€â”€ manifest.json          # Plugin-Definition
â”œâ”€â”€ actions/               # Button-Icons & Inspectors
â””â”€â”€ libs/                  # Stream Deck SDK
```

### UUIDs
- **Plugin:** `de.blackmautz.telemetry.universal`
- **Actions:** `de.blackmautz.telemetry.universal.*`

### API-Endpunkt
- **The Bus API:** `http://127.0.0.1:37337`

### Bus-Erkennung
Das Plugin erkennt automatisch welcher Bus aktiv ist:
- **Solaris:** Nutzt Standard-API mit `AllLamps` und `Buttons`
- **Mercedes:** Nutzt Standard-API mit zusÃ¤tzlichen Interior Light Events
- **Scania:** Nutzt `/vehicles/current` Fallback und `Doors[]` Property
- **VDL Citea LLE:** Nutzt `/vehicles/current` mit `InteriorLightLevel` Button fÃ¼r 3-State Interior Lights

## ğŸ‘¨â€ğŸ’» Credits

- **Original Plugin:** TML Studios
- **Solaris Edition:** BlackMautz
- **Mercedes Edition:** BlackMautz  
- **Universal Edition:** BlackMautz
- **Scania Support:** BlackMautz

## ğŸ“„ Lizenz

Basierend auf dem TML Telemetry Plugin mit Erweiterungen von BlackMautz.

## ğŸ› Support

Bei Problemen oder Fragen:
- **GitHub Issues:** [Report a Bug](https://github.com/BlackMautz/BlackMautz_telemetry_TheBus-streamdeck-custom/issues)

---

**Viel SpaÃŸ beim Fahren! ğŸšŒğŸ’¨**

---

<br>
<br>
<br>
<br>

# ğŸ‡ºğŸ‡¸ English

**A Stream Deck Plugin for ALL buses in The Bus!**

Supports **Solaris Urbino**, **Mercedes eCitaro**, **Scania Citywide** AND **VDL Citea LLE** with all features in one plugin!

**Version 2.0.4** - All functions tested and working in all four buses!

## ğŸ“¥ Installation & Updates

### Installation
1. **[Download v2.0.4](https://github.com/BlackMautz/BlackMautz_telemetry_TheBus-streamdeck-custom/releases)** - Latest `.streamDeckPlugin` file
2. **Double-click** the file
3. **Done!** Stream Deck installs automatically

### ğŸ”” Never miss updates!
Click **"Watch"** â†’ **"Custom"** â†’ **"Releases"** âœ…  
â†’ Get automatic email notifications when new updates are available! ğŸ“§

---

## ğŸ® All Features at a Glance

**45 Buttons with 100+ individual functions!**

### ğŸšª Door Control (5 Buttons)
- **Door 1-4** - Open/close individual doors with lock function
  - ğŸ“Š Door Progress Display (shows opening %, Scania: 0-100%, others: 0%/100%)
- **Change Door** - 6 options:
  - First Door Open/Close
  - Second Door Open/Close
  - Third Door Open/Close
  - Fourth Door Open/Close
  - All Doors Open/Close
  - Automatic Door Closing

### ğŸ’° Cash System (2 Buttons)
- **Payment Status** - Payment status display
- **Change Action** - Return change

### âš™ï¸ Vehicle Control (6 Buttons)
- **Gear Select** - Automatic gear selection (D/N/R)
- **Ignition** - Ignition on/off
- **Start Engine** - Start/stop engine
- **Fixing Brake** - Parking brake toggle
- **Stop Brake (Mercedes)** - Station brake
- **Wheelchair Ramp** - Extend/retract ramp

### ğŸ’¡ Lighting (7 Buttons with 40+ options!)
- **Light Control** - 15+ light options:
  - Interior Lights On/Off
  - Side/Rear/Front Lights On/Off
  - Hazard Lights On/Off
  - Turn Signals Left/Right On/Off
  - Fog Lights Front/Rear On/Off
  - High Beam On/Off
  - All Lights On/Off
- **Light Switch** - 3-way switch with 6 positions:
  - Switch Right: Off â†’ Parking â†’ Headlights â†’ High Beam â†’ Fog Front â†’ Fog Rear
  - Switch Left (reverse)
  - Show Status
- **Indicator Control** - 3 options:
  - Turn Signal Left/Right
  - Hazard Lights
- **Scania Lights (Scania)** - 6 options:
  - Fog Light Front/Rear
  - Interior Light Front/Back Up (Dimmed)
  - Interior Light Front/Back Down (Bright)
- **Interior Light Dim (Mercedes/VDL)** - Interior lighting 30% dimmed toggle
- **Interior Light Full (Mercedes/VDL)** - Interior lighting 100% bright toggle
- **Reading Light Clearance (VDL)** - Reading light clearance for passengers

### ğŸªŸ Windows & Climate (3 Buttons)
- **Window Control** - 10 options:
  - Driver Window Open/Close
  - Window Shade Up/Down
  - Window Shade Side Up/Down (VDL)
  - Window Shade Front Up/Down (Scania)
  - Window Shade Left Up/Down (Scania)
- **Window/Mirror Heating** - Window/mirror heating toggle
- **Climate Control** - Display temperature & ventilation

### ğŸ”½ Kneeling & Lifting (2 Buttons)
- **Kneeling/Lifting** - 6 options:
  - Lifting Front
  - Lifting Rear
  - Kneeling Front
  - Kneeling Rear
  - Lifting
  - Kneeling

### ğŸŒ§ï¸ Windshield Wipers (2 Buttons)
- **Wiper Speed Up** - Increase level
- **Wiper Speed Down** - Decrease level

### ğŸ“¯ Horn & Signals (2 Buttons)
- **Horn** - Horn
- **Flash High Beam** - Flash high beam/headlight flasher

### ğŸ“¹ Cameras (1 Button)
- **Camera Switch** - Switch camera (works with all 4 buses!)

### ğŸš¦ Special Features (5 Buttons)
- **Pantograph On/Off (Solaris)** - Pantograph for trolleybus
- **Retarder Toggle** - Engine brake/retarder (universal)
- **Traction Control (ASR)** - Traction control toggle (universal)
- **RBL Toggle** - Traffic signal priority system for green wave
  - Computer-controlled operating system
  - Bus automatically gets green lights at intersections
- **USB Clearance** - USB clearance

### ğŸ“Š Info Displays (5 Buttons)
- **Fuel Info** - Display fuel level
- **Passengers Info** - Display passenger count
- **Engine Info** - Display engine status
- **Speed Info** - Display speed
- **Stop Request** - Stop request display

### ğŸ›ï¸ Advanced Features (2 Buttons)
- **Custom Action** - Custom events without button function
- **Custom Button** - Custom events with button function

### ğŸ’¡ Monitoring (1 Button)
- **LED Monitor** - Monitor all LED states

---

## ğŸ¯ Compatibility

| Feature | Solaris Urbino | Mercedes eCitaro | Scania Citywide | VDL Citea LLE |
|---------|:--------------:|:----------------:|:---------------:|:-------------:|
| All Standard Features | âœ… | âœ… | âœ… | âœ… |
| Door Progress Display | âš ï¸ (doors only) | âš ï¸ (doors only) | âœ… (0-100%) | âš ï¸ (doors only) |
| Light Switch | âœ… | âœ… | âœ… | âœ… |
| Pantograph | âœ… | âŒ | âŒ | âŒ |
| Interior Light Toggles | âŒ | âœ… | âŒ | âœ… |
| Stop Brake | âŒ | âœ… | âŒ | âŒ |
| Unified DoorLock | âŒ | âŒ | âœ… | âŒ |
| Scania Lights | âŒ | âŒ | âœ… | âŒ |
| Reading Light | âŒ | âŒ | âŒ | âœ… |
| Retarder | âœ… | âœ… | âœ… | âœ… |
| Traction Control (ASR) | âœ… | âœ… | âœ… | âœ… |
| RBL | âœ… | âœ… | âœ… | âœ… |

**Note:** Bus-specific buttons are marked in the name. Universal features work in all buses!

## âœ¨ Highlights

### ğŸš€ What's new in v2.0.4?
- ğŸš¦ **Retarder, ASR & RBL** - Professional bus features for all 4 buses
- ğŸ’¡ **VDL Reading Light** - Reading light clearance for passengers
- ğŸ”„ **Traffic Signal Priority System (RBL)** - Automatically get green lights at intersections
- ğŸ“Š **API-based Icon Synchronization** - Icons always show the real bus status

### ğŸ¯ Why this plugin?
- âœ… **All 4 buses** in one plugin - no more separate downloads!
- âœ… **100+ functions** - Complete bus control from Stream Deck
- âœ… **Smart Icons** - Automatically show current status
- âœ… **Door Progress** - See door opening in real-time (Scania: 0-100%)
- âœ… **Light Switch** - Cycle through all 6 light positions with one button
- âœ… **Custom Events** - Create your own buttons for special actions

---

## ğŸ“‹ Changelog

### v2.0.4 - VDL Extended Features (2025-11-29)
- ğŸ’¡ **Reading Light Clearance** - Reading light clearance for passengers (VDL)
- ğŸš¦ **Retarder Toggle** - Engine brake/retarder on/off (universal)
- ğŸš— **Traction Control (ASR)** - Traction control toggle (universal)
- ğŸš¦ **RBL Toggle** - Traffic signal priority system for green wave
  - RBL = Rechnergesteuertes Betriebsleitsystem (Computer-controlled Operating System)
  - Computer-controlled system for automatic green phases at traffic lights
  - Bus reports to traffic lights and automatically gets green
  - Commonly used in Germany/Austria for public transit
- ğŸ“¹ **Camera Switch Fix** - Now works with all 4 buses (SwitchPreviousCamera for VDL)

### v2.0.3 - VDL Citea LLE Support (2025-11-29)
- âœ¨ **VDL Citea LLE Support** - Fourth bus fully supported!
- ğŸ’¡ **VDL Interior Light Toggles** - Dimmed (30%) and Bright (100%)
- ğŸ”„ **API-based Status Synchronization** - Icons synchronize with bus status
- ğŸ“Š **3-State Interior Lights** - Primary (Off), Secondary (Bright), Tertiary (Dimmed)
- ğŸšª **VDL Door Events** - Event names adapted for VDL

### v2.0.2 - Scania Support & Door Progress (2025-11-29)
- âœ¨ **Scania Citywide Support** - Third bus fully supported!
- ğŸ“Š **Door Progress Display** - Shows door opening in % (Scania: 0-100%)
- ğŸ’¡ **Light Switch Button** - 3-way switch for 6 light positions
- ğŸ’¡ **Scania Lights Button** - Fog lights + interior lighting
- ğŸªŸ **Window Shade Scania** - Front/Left Up/Down options

### v2.0.0 - Universal Edition (2025-11-28)
- âœ¨ **First Universal Version** - Solaris & Mercedes in one plugin
- âœ… All features of both buses combined
- âœ… Separate category "BlackMautz TML Telemetry - ALL"

---

## ğŸ’» For Developers

### Plugin Structure
```
de.blackmautz.telemetry.universal.sdPlugin/
â”œâ”€â”€ app.js                 # Main logic
â”œâ”€â”€ manifest.json          # Plugin definition
â”œâ”€â”€ actions/               # Button icons & inspectors
â””â”€â”€ libs/                  # Stream Deck SDK
```

### UUIDs
- **Plugin:** `de.blackmautz.telemetry.universal`
- **Actions:** `de.blackmautz.telemetry.universal.*`

### API Endpoint
- **The Bus API:** `http://127.0.0.1:37337`

### Bus Detection
The plugin automatically detects which bus is active:
- **Solaris:** Uses standard API with `AllLamps` and `Buttons`
- **Mercedes:** Uses standard API with additional Interior Light Events
- **Scania:** Uses `/vehicles/current` fallback and `Doors[]` property
- **VDL Citea LLE:** Uses `/vehicles/current` with `InteriorLightLevel` button for 3-state Interior Lights

## ğŸ‘¨â€ğŸ’» Credits

- **Original Plugin:** TML Studios
- **Solaris Edition:** BlackMautz
- **Mercedes Edition:** BlackMautz
- **Universal Edition:** BlackMautz
- **Scania Support:** BlackMautz
- **VDL Support:** BlackMautz

## ğŸ“„ License

Based on the TML Telemetry Plugin with extensions by BlackMautz.

## ğŸ› Support

For issues or questions:
- **GitHub Issues:** [Report a Bug](https://github.com/BlackMautz/BlackMautz_telemetry_TheBus-streamdeck-custom/issues)

---

**Have fun driving! ğŸšŒğŸ’¨**
